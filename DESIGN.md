# 🔥 Fire Emblem: Shadow of the Verdant Star
# 《火炎之紋章：翠星之影》

## Game Design Document

---

## 世界觀

**大陸名：** 艾爾德拉（Eldra）

千年前，五顆星辰墜落大陸，化為五枚「星印」（Star Crests），賦予持有者操控元素之力。五大王國各持一枚星印，維持千年和平。

然而，第六顆星辰——翠星（Verdant Star）——一直隱藏在世界的裂縫中。當帝國宰相發現翠星的存在，他發動政變，企圖集齊六枚星印，成為神。

主角是帝國公主，政變之夜被迫流亡，帶著父王臨終交付的星印，踏上反抗之路。

---

## 角色（8人）

### 主角
1. **艾琳（Eirine）** — 帝國公主 / Lord
   - 武器：劍
   - 性格：堅毅但內心掙扎，被迫從溫室花朵成長為領袖
   - 成長：HP↑ STR↑ SPD↑↑

### 第1章加入
2. **馬庫斯（Marcus）** — 帝國騎士 / Paladin（預升級）
   - 武器：劍、槍
   - 性格：忠誠老將，曾服侍先王。初期強但成長率低（典型 Jagen）
   - 成長：低（Jagen 角色）

3. **莉娜（Lina）** — 弓箭手 / Archer
   - 武器：弓
   - 性格：孤兒出身的獵人，率直毒舌
   - 成長：SPD↑↑ SKL↑↑ DEF↓

### 第2章加入
4. **托爾（Thor）** — 戰士 / Fighter
   - 武器：斧
   - 性格：北方蠻族勇士，豪邁但心思細膩
   - 成長：HP↑↑ STR↑↑ SPD↓

5. **賽拉（Serra）** — 修女 / Cleric
   - 武器：杖
   - 性格：溫柔的教會修女，暗藏秘密
   - 成長：MAG↑↑ RES↑↑ DEF↓

### 第3章加入
6. **凱恩（Cain）** — 傭兵 / Mercenary
   - 武器：劍
   - 性格：冷酷傭兵，只為錢。後來被主角感化
   - 成長：STR↑ SPD↑ SKL↑（均衡型）

### 第4章加入
7. **法蘭（Fran）** — 魔法師 / Mage
   - 武器：魔法書
   - 性格：年輕天才魔法師，自大但實力強
   - 成長：MAG↑↑↑ SPD↑ DEF↓↓

### 第5章加入
8. **雷克斯（Rex）** — 飛龍騎士 / Wyvern Rider
   - 武器：槍
   - 性格：叛離帝國的飛龍騎士團副團長
   - 成長：STR↑ DEF↑ RES↓（弱魔法）

---

## 職業系統

### 基礎職業 → 轉職（Lv20）
| 基礎 | 轉職A | 轉職B |
|------|-------|-------|
| Lord | Master Lord | — |
| Cavalier | Paladin | Great Knight |
| Archer | Sniper | Ranger |
| Fighter | Warrior | Hero |
| Cleric | Bishop | Valkyrie |
| Mercenary | Hero | Swordmaster |
| Mage | Sage | Mage Knight |
| Wyvern Rider | Wyvern Lord | — |

### 武器三角
```
劍 > 斧 > 槍 > 劍
```
優勢方：命中 +15, 攻擊 +1
劣勢方：命中 -15, 攻擊 -1

### 魔法三角
```
火 > 風 > 雷 > 火
```
（光、暗互克）

---

## 屬性系統

| 屬性 | 縮寫 | 說明 |
|------|------|------|
| HP | HP | 生命值 |
| 力量 | STR | 物理攻擊力 |
| 魔力 | MAG | 魔法攻擊力 |
| 技巧 | SKL | 命中率、必殺率 |
| 速度 | SPD | 迴避率、追擊判定 |
| 幸運 | LCK | 迴避必殺 |
| 防禦 | DEF | 物理防禦 |
| 魔防 | RES | 魔法防禦 |
| 移動 | MOV | 移動格數 |

### 戰鬥公式
```
物攻 = STR + 武器攻擊力
魔攻 = MAG + 魔法攻擊力
命中 = SKL×2 + LCK + 武器命中 + 武器三角
迴避 = SPD×2 + LCK + 地形迴避
傷害 = 攻擊 - 防禦（最低1）
必殺率 = SKL/2
追擊條件 = 速度差 ≥ 5
```

---

## 地形效果

| 地形 | 防禦加成 | 迴避加成 | 移動消耗 |
|------|---------|---------|---------|
| 平地 | 0 | 0 | 1 |
| 森林 | +1 | +20 | 2 |
| 山地 | +2 | +30 | 3（飛行=1）|
| 城牆 | +3 | +20 | 2 |
| 城門 | +3 | +30 | 1 |
| 河流 | 0 | 0 | 不可通行（飛行=1）|
| 村莊 | 0 | +10 | 1（可訪問觸發事件）|

---

## 章節設計（6章）

### 序章：「墜落之夜」
- **劇情：** 帝國宮殿政變。宰相莫爾甘帶兵攻入。國王犧牲自己讓艾琳逃走。
- **地圖：** 宮殿走廊（小型，8×6）
- **目標：** 艾琳到達地圖右下出口
- **敵人：** 5個帝國士兵（弱）
- **加入：** 艾琳、馬庫斯
- **教學：** 移動、攻擊基礎

### 第1章：「荒野的邂逅」
- **劇情：** 逃入荒野，遇到獵人莉娜。帝國追兵來襲。
- **地圖：** 森林與草原（12×10）
- **目標：** 殲滅所有敵人
- **敵人：** 8個（含1個弓兵）
- **加入：** 莉娜
- **教學：** 武器三角、地形效果

### 第2章：「北境之村」
- **劇情：** 到達北方村莊，遇到托爾和賽拉。村莊遭山賊攻擊。
- **地圖：** 村莊防禦戰（14×12）
- **目標：** 保護3個村莊（NPC），堅持8回合
- **敵人：** 12個（分波來襲）
- **加入：** 托爾、賽拉
- **新機制：** 回復魔法、防禦戰

### 第3章：「傭兵的代價」
- **劇情：** 途中遇到傭兵團。凱恩受僱攻擊主角，戰鬥中被說服。
- **地圖：** 峽谷（12×10，有橋）
- **目標：** 說服凱恩（艾琳接觸）+ 殲滅
- **敵人：** 10個（凱恩初始為敵方，說服後加入）
- **加入：** 凱恩（需要艾琳對話）
- **新機制：** 說服/招募

### 第4章：「魔法塔」
- **劇情：** 尋找傳說中的魔法師協助。法蘭在魔法塔頂研究禁術。
- **地圖：** 塔內（10×14，多層感）
- **目標：** 艾琳到達塔頂
- **敵人：** 10個魔法師 + 2個骷髏兵
- **加入：** 法蘭
- **新機制：** 魔法攻擊、魔防重要性

### 第5章：「翠星之戰」（最終章）
- **劇情：** 攻入帝都。雷克斯率飛龍騎士團叛變支援。最終對決莫爾甘。
- **地圖：** 帝都城門（16×14，大型）
- **目標：** 擊敗 Boss 莫爾甘
- **敵人：** 15個 + Boss
- **加入：** 雷克斯（第2回合增援）
- **Boss：** 莫爾甘（Dark Mage，持翠星，極強）

---

## AI 設計

### 敵人行為模式
1. **追擊型（Aggressive）：** 直接向最近敵人移動攻擊
2. **防守型（Defensive）：** 不主動移動，攻擊範圍內才行動
3. **Boss 型：** 固定位置，等待玩家接近

### 目標選擇優先
1. 可以一擊殺死的目標
2. HP 最低的目標
3. 武器三角有利的目標
4. 最近的目標

---

## 美術風格

- **地圖：** 16×16 pixel tiles，GBA 風格俯視
- **角色：** 地圖上用 16×16 sprites（簡化版）
- **戰鬥：** 無獨立戰鬥畫面（直接在地圖上顯示傷害數字）
- **對話：** 底部文字框 + 角色立繪（大頭像）
- **顏色：** 藍方（玩家）、紅方（敵人）、綠方（NPC/友軍）
- **UI：** 右側面板顯示選中角色資訊

---

## 技術架構

```
fire-emblem/
├── index.html          # 入口
├── css/
│   └── style.css       # UI 樣式
├── js/
│   ├── main.js         # 遊戲初始化、主循環
│   ├── game.js         # 遊戲狀態管理
│   ├── map.js          # 地圖渲染、地形
│   ├── unit.js         # 角色類、屬性、升級
│   ├── combat.js       # 戰鬥計算
│   ├── ai.js           # 敵方 AI
│   ├── ui.js           # UI 面板、選單
│   ├── dialogue.js     # 對話系統
│   ├── cursor.js       # 游標控制
│   ├── sprites.js      # Sprite 繪製（程式生成）
│   └── data/
│       ├── chapters.js # 章節數據（地圖、敵人、對話）
│       ├── classes.js  # 職業數據
│       └── items.js    # 武器數據
└── DESIGN.md           # 本文件
```

全部用 Canvas 繪製，零外部依賴。Sprites 用程式生成（procedural pixel art），不需要圖片檔案。
