<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>è·æ¥­åœ–é‘‘ â€” ç¿ æ˜Ÿä¹‹å½±</title>
<style>
* { margin:0; padding:0; box-sizing:border-box; }
body { background:#1a1a2e; color:#ccc; font-family:'Segoe UI',sans-serif; padding:20px; }
h1 { text-align:center; color:#e8d080; font-size:24px; margin-bottom:8px; }
.subtitle { text-align:center; color:#888; font-size:13px; margin-bottom:24px; }

.table-container { overflow-x: auto; max-width: 1200px; margin: 0 auto; }
table { width: 100%; border-collapse: collapse; background: #16213e; border: 2px solid #334; border-radius: 8px; overflow: hidden; min-width: 620px; }
th, td { padding: 8px; text-align: left; border-bottom: 1px solid #334; font-size: 13px; }
th { background: #111827; color: #e8d080; font-weight: bold; white-space: nowrap; position: sticky; top: 0; font-size: 14px; }
tr:hover { background: #1e293b; }
tr:last-child td { border-bottom: none; }

.sprite-col { width: 44px; min-width: 44px; text-align: center; }
.sprite-col canvas { display: inline-block; vertical-align: middle; max-width: 40px; max-height: 40px; }

.class-name { color: #e8d080; font-size: 14px; font-weight: bold; }
.class-id { color: #666; font-size: 11px; }

.tags { display: inline-flex; gap: 4px; flex-wrap: wrap; }
.tag { background: #334; color: #aaa; padding: 1px 5px; border-radius: 4px; font-size: 10px; }

.weapons { color: #8ab; font-size: 12px; }
.mov { color: #ccc; font-weight: bold; font-size: 12px; }

.stats { font-size: 10px; color: #aaa; white-space: nowrap; }
.stats span { display: inline-block; width: 27px; text-align: right; }
.stats .lbl { color: #666; width: auto; margin-right: 2px; }

.promo { font-size: 10px; color: #ffa500; }
.promo-list { color: #8ab; }

@media (max-width: 700px) {
  h1 { font-size: 18px; }
  .subtitle { font-size: 11px; margin-bottom: 16px; }
  .table-container { padding: 0; max-width: 100vw; }
  table { min-width: 480px; font-size: 12px; }
  th, td { padding: 5px 4px 5px 4px; font-size: 11px; }
  .sprite-col { width: 28px; min-width: 28px; }
  .stats { font-size: 9px; display: flex; flex-direction: column; white-space: normal; }
  .stats span { width: auto !important; text-align: left !important; display: inline-block !important; }
  .tags { display: flex; flex-direction: column; gap: 0; align-items: flex-start; }
  .tag { font-size: 9px; margin-bottom: 1px; }
  .weapons { display: flex; flex-direction: column; font-size: 10px; }
  .promo, .promo-list { font-size: 9px; }
  .class-name { font-size: 11px; }
}

</style>
</head>
<body>
<h1>âš”ï¸ è·æ¥­åœ–é‘‘</h1>
<p class="subtitle">ç¿ æ˜Ÿä¹‹å½± â€” å…¨è·æ¥­ä¸€è¦½</p>

<div class="table-container">
  <table>
    <thead>
      <tr>
        <th class="sprite-col"></th>
        <th>è·æ¥­</th>
        <th>æ­¦å™¨</th>
        <th>MOV</th>
        <th>é¡å‹</th>
        <th>åŠ æˆ</th>
        <th>è½‰è·</th>
      </tr>
    </thead>
    <tbody id="class-list"></tbody>
  </table>
</div>

<script src="../js/data/items.js"></script>
<script src="../js/data/classes.js"></script>
<script src="../js/data/chapters.js"></script>
<script src="../js/sprites.js"></script>
<script>
// Minimal GameMap stub for sprites
const GameMap = { tileSize:32, scale:2, width:20, height:15, terrain:[], getTerrain:()=>'plain', screenToTile:()=>({x:0,y:0}), camX:0, camY:0 };

const WEAPON_NAMES = { sword:'åŠ', lance:'æ§', axe:'æ–§', bow:'å¼“', staff:'æ–', fire:'ç«', thunder:'é›·', wind:'é¢¨', dark:'æš—' };
const TAG_NAMES = { armored:'ğŸ›¡ï¸ é‡è£', cavalry:'ğŸ é¨å…µ', flying:'ğŸ¦… é£›è¡Œ', mounted:'ğŸ´ ä¹˜é¨', undead:'ğŸ’€ ä¸æ­»æ—' };

function renderList() {
  const tbody = document.getElementById('class-list');
  tbody.innerHTML = '';
  
  const classIds = Object.keys(CLASSES);
  
  classIds.forEach((classId, i) => {
    const cls = CLASSES[classId];
    // åŸæœ¬åˆ†æ•µæˆ‘ï¼Œç¾åœ¨å…¨éƒ¨éƒ½å‡º
    const tr = document.createElement('tr');
    
    // 1. Sprite
    const tdSprite = document.createElement('td');
    tdSprite.className = 'sprite-col';
    const canvas = document.createElement('canvas');
    const scale = 2;
    canvas.width = 40 * scale;
    canvas.height = 40 * scale;
    canvas.style.width = (40 * scale) + 'px';
    canvas.style.height = (40 * scale) + 'px';
    const ctx = canvas.getContext('2d');
    ctx.imageSmoothingEnabled = false;
    ctx.scale(scale, scale);
    
    const hairColors = ['#8040a0','#c04040','#4060c0','#40a040','#a08040','#d08050','#606060','#d0a030'];
    const unit = {
      classId: classId,
      faction: 'player',
      hp: 20, maxHp: 20,
      portrait: { hair: hairColors[i%8], skin:'#fdb', eyes:'#222' },
      isBoss: false,
    };
    Sprites.drawUnit(ctx, unit, 4, 4, false);
    tdSprite.appendChild(canvas);
    tr.appendChild(tdSprite);
    
    // Save for animation loop
    canvas.dataset.classId = classId;
    canvas.dataset.hairIndex = i % 8;
    
    // 2. Class Name
    const tdName = document.createElement('td');
    tdName.innerHTML = `<div class="class-name">${cls.name}</div>`;
    tr.appendChild(tdName);
    
    // 3. Weapons
    const tdWpn = document.createElement('td');
    const wpnNames = (cls.weapons || []).map(w => WEAPON_NAMES[w] || w).join(' / ');
    tdWpn.innerHTML = `<div class="weapons">ğŸ—¡ï¸ ${wpnNames}</div>`;
    tr.appendChild(tdWpn);
    
    // 4. MOV
    const tdMov = document.createElement('td');
    tdMov.innerHTML = `<div class="mov">ğŸƒ ${cls.mov || 5}</div>`;
    tr.appendChild(tdMov);
    
    // 5. Tags
    const tdTags = document.createElement('td');
    if (cls.tags && cls.tags.length > 0) {
      const tagsHtml = cls.tags.map(t => `<span class="tag">${TAG_NAMES[t] || t}</span>`).join('');
      tdTags.innerHTML = `<div class="tags">${tagsHtml}</div>`;
    } else {
      tdTags.innerHTML = ``;
    }
    tr.appendChild(tdTags);
    
    // 6. Bonus Stats
    const tdStats = document.createElement('td');
    const bns = cls.bonus || {};
    tdStats.innerHTML = `
      <div class="stats">
        <span class="lbl">HP</span><span>+${bns.hp ?? 0}</span>
        <span class="lbl">åŠ›</span><span>+${bns.str ?? 0}</span>
        <span class="lbl">é­”</span><span>+${bns.mag ?? 0}</span>
        <span class="lbl">æŠ€</span><span>+${bns.skl ?? 0}</span>
        <span class="lbl">é€Ÿ</span><span>+${bns.spd ?? 0}</span>
        <span class="lbl">é‹</span><span>+${bns.lck ?? 0}</span>
        <span class="lbl">é˜²</span><span>+${bns.def ?? 0}</span>
        <span class="lbl">é­”é˜²</span><span>+${bns.res ?? 0}</span>
      </div>
    `;
    tr.appendChild(tdStats);
    
    // 7. Promotion
    const tdPromo = document.createElement('td');
    if (cls.promo && cls.promo.length > 0) {
      const pNames = cls.promo.map(p => CLASSES[p.to] ? CLASSES[p.to].name : p.to).join(', ');
      tdPromo.innerHTML = `<div class="promo">å¯è½‰è·: <span class="promo-list">${pNames}</span></div>`;
    } else if (cls.promoted) {
      tdPromo.innerHTML = `<div class="promo" style="color:#e8d080">â­ ä¸Šç´šè·</div>`;
      
    } else {
      tdPromo.innerHTML = `<div class="promo" style="color:#666">ç„¡æ³•è½‰è·</div>`;
    }
    tr.appendChild(tdPromo);
    
    tbody.appendChild(tr);
  });
}

window.onload = function() {
  setTimeout(renderList, 100);
};

// Animation loop
setInterval(function() {
  Sprites.tick();
  const canvases = document.querySelectorAll('.sprite-col canvas');
  const hairColors = ['#8040a0','#c04040','#4060c0','#40a040','#a08040','#d08050','#606060','#d0a030'];
  
  canvases.forEach(canvas => {
    const ctx = canvas.getContext('2d');
    ctx.setTransform(1,0,0,1,0,0);
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    ctx.scale(2, 2);
    
    const classId = canvas.dataset.classId;
    const hIndex = parseInt(canvas.dataset.hairIndex) || 0;
    
    const unit = {
      classId: classId,
      faction: 'player',
      hp: 20, maxHp: 20,
      portrait: { hair: hairColors[hIndex], skin:'#fdb', eyes:'#222' },
      isBoss: false,
    };
    Sprites.drawUnit(ctx, unit, 4, 4, false);
  });
}, 200);
</script>
</body>
</html>
